# Verkle Meeting 15

## Meeting Info
March 25, 14:00 UTC

Recording: https://youtu.be/sMbCzWyCqPg

Original notes here: https://twitter.com/rudolf6_/status/1773494895233335759

## This week’s agenda:
1. Client team updates
2. Testing updates
3. Cryptography perf improvements
4. Summary of discussions from ETHTaipei
5. Testnet relaunch



# 1. Client team updates

@gballet
 and 
@ignaciohagopian
 for 
@go_ethereum
:
Continued work on improving the testing around the conversion process (the process that actually converts all state from MPT over to Verkle). Working with Spencer from the testing team and have made solid progress. Also working on the testnet relaunch. Prior to launching the full testnet, to save some time and DevOps resources, we will first dump some test blocks and see if others can execute it.

@gajpower
 for 
@EFJavaScript
:
EthereumJS has been trying to run the blocks and test cases provided by Geth, prior to launching the next testnet. Found and fixed a few issues in EthJS. Next up is to re-verify that it can pass the tests.

@jasoriatanishq
 for 
@nethermindeth
:
Working on the gas model with Guillaume and Gajinder. Also implemented an optimization in the cryptography library. Now focusing on implementing the actual transition in Nethermind.

Daniel for 
@ethnimbus
:
Made some good progress on handling integration into the Nimbus client. Just doing a basic integration to start things off. Will likely be able to join the testnet in the next few weeks.

@kt2am1990
 for 
@HyperledgerBesu
:
Preparing Besu to join the testnet. Completed gas cost modifications. Also made some changes in order to have the circular buffer for blockhash. And made some modifications to the trie key generation, as well as some performance stuff in order to optimize the communication between the Java side and the native side.


# 2. Testing updates

Spencer from the testing team joined to give a quick update on the testing side of things:

We now have the transition tool, which generates a test and verifies that the Verkle tree post-state is as expected. This is done using a subcommand that Guillaume added to Geth. The subcommand is used to generate a Verkle tree and compare against the Verkle tree generated by the transition tool. Still some optimizations to do, as right now it takes about 2 mins to generate a single test, and we need to try to get it down to around 1 sec.

As a next step: we want to try and complete not just the filling of the test, but also the consumption of the test. Continued work on the testing front over the coming weeks and months!


# 3. Cryptography perf improvements in Verkle

Next up, 
@ignaciohagopian
 took some time to walk through some exciting performance improvements he’s been working on regarding multiscalar multiplication (MSM) in Verkle. See Ignacio’s doc here: https://hackmd.io/@jsign/vkt-another-iteration-of-vkt-msms, which was motivated in part by previous work by 
@GottfriedHerold
 from the EF cryptography team.

Also for extra background (somewhat unrelated), see this paper from 
@paradigm
 and Georgios for a bit more info on MSMs in the context of zk proofs: https://paradigm.xyz/2022/04/zk-hardware

The basic idea is exploring how we can use some clever cryptography and precomputations to speed up the performance of Verkle in Geth’s crypto library, but the core ideas apply to any crypto implementation of Verkle. Why are MSMs important? Well it’s a bit of math we have to do in several areas with Verkle. e.g. when we do the actual migration from the Merkle Patricia Tree to Verkle Trees. Also more generally when calculating tree keys or updating tree nodes.

This work has potential to improve performance in several areas where MSMs are used, including as mentioned in the actual migration of historic state from the existing MPT over to Verkle at the time of the upgrade. Recommend watching the recording / reading the full doc for those interested in the full deep dive.

# 4. Summary of discussions from ETHTaipei

Next up, 
@gballet
 shared a summary of some conversations from ETHTaipei, and potential updates to the Verkle spec/EIPs. This included some conversations with 
@jbaylina
 and 
@VitalikButerin
 mostly around three EIPs: 4762 (gas cost updates), 2935 (historical block hashes in state), and 7545 (proof verification precompile). Quick summaries of each: 

With EIP-4762: the goal is to keep the gas costs unchanged as much as possible, post-verkle. We will update the EIP to make sure this is clear and easy to understand.

With EIP-2935: discussed with 
@jbaylina
 whether 256 blocks is enough. They would rather have 2 weeks worth of blocks available, rather than just 256. Still tbd and more discussions need to happen on the best way to go about achieving our goals here.

With EIP-7545: L2s are in favor of this change, as they want to update their contract to use the precompile, rather than rushing to update their contracts at the moment when the fork happens. What they would like is a precompile that is agnostic to the proof format, that they can just pass a blob to. And then the contract is aware of whether the fork has happened or not. Ideally this EIP gets included in Prague, rather than waiting to ship it with Osaka (which is the fork that will contain Verkle).


# 5. Testnet relaunch

Last up, thoughts on the new testnet rollout. 
@gballet
 wanted to see if any questions from other client teams on the test blocks he produced, prior to the launching of the full testnet. We decided to continue discussion of this topic offline, as it was better suited for more of a pair programming type session :)

That’s it for this week’s call! Check  or head over to the Eth R&D Discord (verkle-trie-migration channel) to stay up-to-date
